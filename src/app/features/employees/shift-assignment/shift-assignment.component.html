<div class="shift-container">
  <div class="header">
    <button (click)="goBack()" class="btn-back" aria-label="Volver">← Volver</button>
    <h1>Asignar Turno</h1>
    <button (click)="logout()" class="btn-logout" aria-label="Cerrar sesión">
      Cerrar Sesión
    </button>
  </div>

  @if (isLoading()) {
    <div class="loading" aria-busy="true">
      <div class="spinner"></div>
      <p>Cargando...</p>
    </div>
  } @else if (employee()) {
    <div class="shift-form-container">
      <div class="employee-info">
        <h2>{{ employee()!.name }}</h2>
        <p><strong>Email:</strong> {{ employee()!.email }}</p>
      </div>

      @if (successMessage()) {
        <div class="success-message" role="alert">
          ✓ {{ successMessage() }}
        </div>
      }

      @if (errorMessage()) {
        <div class="error-message" role="alert">
          {{ errorMessage() }}
        </div>
      }

      <form [formGroup]="shiftForm" (ngSubmit)="onSubmit()" class="shift-form">
        <div class="form-group">
          <label for="date">Fecha:</label>
          <input
            id="date"
            type="date"
            formControlName="date"
            [class.is-invalid]="date?.invalid && date?.touched"
            aria-describedby="dateError"
          />
          @if (date?.invalid && date?.touched) {
            <span id="dateError" class="error-text">Fecha requerida</span>
          }
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="startTime">Hora de Inicio:</label>
            <input
              id="startTime"
              type="time"
              formControlName="startTime"
              [class.is-invalid]="startTime?.invalid && startTime?.touched"
              aria-describedby="startTimeError"
            />
            @if (startTime?.invalid && startTime?.touched) {
              <span id="startTimeError" class="error-text">Hora requerida</span>
            }
          </div>

          <div class="form-group">
            <label for="endTime">Hora de Fin:</label>
            <input
              id="endTime"
              type="time"
              formControlName="endTime"
              [class.is-invalid]="endTime?.invalid && endTime?.touched"
              aria-describedby="endTimeError"
            />
            @if (endTime?.invalid && endTime?.touched) {
              <span id="endTimeError" class="error-text">Hora requerida</span>
            }
          </div>
        </div>

        @if (timeRangeError) {
          <div class="error-message">
            La hora de fin debe ser mayor que la hora de inicio
          </div>
        }

        <div class="form-actions">
          <button
            type="submit"
            [disabled]="shiftForm.invalid || isSubmitting()"
            class="btn-submit"
          >
            @if (isSubmitting()) {
              Guardando...
            } @else {
              Asignar Turno
            }
          </button>
          <button type="button" (click)="goBack()" class="btn-cancel">
            Cancelar
          </button>
        </div>
      </form>
    </div>
  }
</div>
